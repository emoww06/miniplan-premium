<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>MiniPlan - GÃ¼nlÃ¼k Plan + AI Motive Geri Bildirim</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="GÃ¼nlÃ¼k hedeflerinizi planlayÄ±n, takip edin ve AI destekli motivasyon alÄ±n">
    <meta name="theme-color" content="#2196F3">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MiniPlan">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <!-- Security Meta Tags -->
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="manifest" href="manifest.json">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- KullanÄ±cÄ± Kurulum Modal -->
    <div id="userSetupModal" class="auth-modal">
        <div class="auth-container">
            <div class="auth-header">
                <div class="logo">ğŸ¯</div>
                <h1>MiniPlan Premium</h1>
                <p>Hedeflerinizi takip edin, baÅŸarÄ±ya ulaÅŸÄ±n!</p>
            </div>
            
            <div class="auth-form">
                <h2>HoÅŸ Geldiniz!</h2>
                <p style="margin-bottom: 20px; color: #666;">Kullanmaya baÅŸlamak iÃ§in kullanÄ±cÄ± adÄ±nÄ±zÄ± belirleyin:</p>
                <input type="text" id="userNameInput" class="auth-input" placeholder="KullanÄ±cÄ± AdÄ±nÄ±z" required>
                <button onclick="createUser()" class="auth-btn">BaÅŸla</button>
            </div>
        </div>
    </div>

    <!-- ArkadaÅŸ Modal -->
    <div id="friendsModal" class="auth-modal" style="display: none;">
        <div class="auth-container" style="max-width: 600px;">
            <div class="auth-header">
                <div class="logo">ğŸ‘¥</div>
                <h1>ArkadaÅŸlarÄ±m</h1>
                <p>ArkadaÅŸlarÄ±nÄ±zla hedeflerinizi paylaÅŸÄ±n ve motivasyonunuzu artÄ±rÄ±n!</p>
            </div>
            
            <div class="auth-form">
                <h2>ArkadaÅŸ Ekle</h2>
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <input type="text" id="friendNameInput" class="auth-input" placeholder="ArkadaÅŸ AdÄ±" style="flex: 1;">
                    <input type="text" id="friendCodeInput" class="auth-input" placeholder="ArkadaÅŸ Kodu" style="flex: 1;">
                    <button onclick="addFriend()" class="auth-btn" style="width: auto;">Ekle</button>
                </div>
                
                <h3>ArkadaÅŸ Listesi</h3>
                <div id="friendsList" style="max-height: 300px; overflow-y: auto; margin-bottom: 20px;">
                    <!-- ArkadaÅŸlar buraya gelecek -->
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <h4>ğŸ“‹ Sizin Kodunuz</h4>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="text" id="myCode" class="auth-input" readonly style="background: #e9ecef;">
                        <button onclick="copyMyCode()" class="auth-btn" style="width: auto;">Kopyala</button>
                    </div>
                    <p style="font-size: 12px; color: #666; margin-top: 10px;">
                        Bu kodu arkadaÅŸlarÄ±nÄ±zla paylaÅŸÄ±n ki sizi ekleyebilsinler!
                    </p>
                </div>
                
                <button onclick="closeFriendsModal()" class="auth-btn" style="background: #6c757d;">Kapat</button>
            </div>
        </div>
    </div>

    <!-- Premium Plan Modal -->
    <div id="premiumModal" class="premium-modal" style="display: none;">
        <div class="premium-container">
            <div class="premium-header">
                <div class="premium-logo">ğŸ’</div>
                <h1>MiniPlan Premium</h1>
                <p>Hedeflerinizi bir Ã¼st seviyeye taÅŸÄ±yÄ±n!</p>
            </div>
            
            <div class="premium-plans">
                <div class="plan-card free-plan">
                    <div class="plan-header">
                        <h3>ğŸ†“ Ãœcretsiz</h3>
                        <div class="plan-price">$0</div>
                    </div>
                    <ul class="plan-features">
                        <li>âœ… GÃ¼nlÃ¼k 5 hedef</li>
                        <li>âœ… Temel takvim</li>
                        <li>âœ… Basit istatistikler</li>
                        <li>âœ… GÃ¼nlÃ¼k notlar</li>
                        <li>âœ… Ruh hali takibi</li>
                        <li>âœ… Temel bildirimler</li>
                    </ul>
                    <button class="plan-btn free-btn" onclick="selectFreePlan()">Mevcut Plan</button>
                </div>
                
                <div class="plan-card premium-plan">
                    <div class="plan-badge">POPÃœLER</div>
                    <div class="plan-header">
                        <h3>ğŸ’ Premium</h3>
                        <div class="plan-price">$4.99<span>/ay</span></div>
                    </div>
                    <ul class="plan-features">
                        <li>âœ… SÄ±nÄ±rsÄ±z hedef</li>
                        <li>âœ… GeliÅŸmiÅŸ analitik</li>
                        <li>âœ… AI destekli Ã¶neriler</li>
                        <li>âœ… Sosyal Ã¶zellikler</li>
                        <li>âœ… Ã–zel temalar</li>
                        <li>âœ… Bulut senkronizasyonu</li>
                        <li>âœ… PDF rapor export</li>
                        <li>âœ… Ã–zel rozetler</li>
                        <li>âœ… AkÄ±llÄ± bildirimler</li>
                    </ul>
                    <button class="plan-btn premium-btn" onclick="selectPremiumPlan()">Premium'a GeÃ§</button>
                </div>
            </div>
            
            <div class="premium-footer">
                <p>7 gÃ¼n Ã¼cretsiz deneme â€¢ Ä°stediÄŸiniz zaman iptal edin</p>
                <button class="close-premium" onclick="closePremiumModal()">Kapat</button>
            </div>
        </div>
    </div>

    <!-- Ana Uygulama -->
    <div id="mainApp" class="container" style="display: none;">
        <div class="header">
            <div class="header-controls">
                <button class="theme-toggle" onclick="toggleTheme()" title="Tema DeÄŸiÅŸtir">
                    <i class="fas fa-moon"></i>
                </button>
                <select class="color-picker" onchange="changeColor(this.value)" title="Renk TemasÄ±">
                    <option value="blue">ğŸ”µ Mavi</option>
                    <option value="green">ğŸŸ¢ YeÅŸil</option>
                    <option value="purple">ğŸŸ£ Mor</option>
                    <option value="orange">ğŸŸ  Turuncu</option>
                </select>
                <button id="premiumBtn" class="premium-btn-header" onclick="showPremiumModal()" title="Premium Plan">
                    <span id="premiumStatus">ğŸ†“</span>
                </button>
                <button class="logout-btn" onclick="logout()" title="Ã‡Ä±kÄ±ÅŸ Yap">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
            <div class="user-info">
                <span id="userName">KullanÄ±cÄ±</span>
                <button onclick="showFriendsModal()" class="btn" style="margin-left: 10px; padding: 12px 20px; font-size: 16px; background: rgba(255,255,255,0.3); border: 2px solid rgba(255,255,255,0.5); font-weight: bold; min-height: 50px; min-width: 120px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255,255,255,0.5)'" onmouseout="this.style.background='rgba(255,255,255,0.3)'">
                    ğŸ‘¥ ArkadaÅŸlar
                </button>
            </div>
            <div class="logo">ğŸ¯</div>
            <h1 class="title">MiniPlan Premium</h1>
            <p class="subtitle">GÃ¼nlÃ¼k Plan + AI Motive Geri Bildirim</p>
            <div class="ai-motivation" id="aiMotivation">
                "BugÃ¼n harika bir gÃ¼n olacak! Her adÄ±mÄ±nÄ±z baÅŸarÄ±ya gÃ¶tÃ¼rÃ¼yor. ğŸŒŸ"
            </div>
        </div>

        <div class="main-content">
            <div class="section">
                <h2 class="section-title">
                    <span class="section-icon">ğŸ“…</span>
                    Takvim
                </h2>
                <div class="calendar">
                    <!-- AI Goal Suggestions -->
                    <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 10px;">
                        <h4 style="margin-bottom: 10px;">ğŸ¤– AI Hedef Ã–nerileri</h4>
                        <div id="aiSuggestions" style="font-size: 14px; line-height: 1.5;">
                            <!-- AI suggestions will appear here -->
                        </div>
                        <button class="btn" style="margin-top: 10px; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3);" onclick="generateAISuggestions()">
                            Yeni Ã–neriler Al
                        </button>
                    </div>
                    
                    <div class="calendar-header">
                        <button class="calendar-nav" onclick="previousMonth()">â€¹</button>
                        <div class="calendar-title" id="calendarTitle">Ocak 2025</div>
                        <button class="calendar-nav" onclick="nextMonth()">â€º</button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Takvim gÃ¼nleri buraya gelecek -->
                    </div>
                </div>

                <!-- KiÅŸisel BÃ¶lÃ¼mler -->
                <div style="margin-top: 20px;">
                    
                    <!-- GÃ¼nlÃ¼k Notlar -->
                    <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 15px; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">ğŸ“</span>
                            GÃ¼nlÃ¼k Notlar
                        </h4>
                        <textarea id="dailyNotes" placeholder="BugÃ¼n iÃ§in notlarÄ±nÄ±zÄ± yazÄ±n..." style="width: 100%; min-height: 80px; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-family: inherit; resize: vertical;" onchange="saveNotes()"></textarea>
                        <div style="margin-top: 10px; display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 12px; color: #666;">NotlarÄ±nÄ±z otomatik kaydedilir</span>
                            <button onclick="clearNotes()" class="btn-secondary" style="padding: 6px 12px; font-size: 12px;">Temizle</button>
                        </div>
                    </div>

                    <!-- Ruh Hali Takibi -->
                    <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 15px; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">ğŸ˜Š</span>
                            BugÃ¼n NasÄ±l Hissediyorsunuz?
                        </h4>
                        <div style="display: flex; justify-content: space-around; margin-bottom: 15px;">
                            <button onclick="setMood('excellent')" class="mood-btn" data-mood="excellent">
                                <span style="font-size: 24px;">ğŸ˜„</span>
                                <span style="font-size: 12px;">MÃ¼kemmel</span>
                            </button>
                            <button onclick="setMood('good')" class="mood-btn" data-mood="good">
                                <span style="font-size: 24px;">ğŸ˜Š</span>
                                <span style="font-size: 12px;">Ä°yi</span>
                            </button>
                            <button onclick="setMood('okay')" class="mood-btn" data-mood="okay">
                                <span style="font-size: 24px;">ğŸ˜</span>
                                <span style="font-size: 12px;">Normal</span>
                            </button>
                            <button onclick="setMood('bad')" class="mood-btn" data-mood="bad">
                                <span style="font-size: 24px;">ğŸ˜”</span>
                                <span style="font-size: 12px;">KÃ¶tÃ¼</span>
                            </button>
                            <button onclick="setMood('terrible')" class="mood-btn" data-mood="terrible">
                                <span style="font-size: 24px;">ğŸ˜¢</span>
                                <span style="font-size: 12px;">Ã‡ok KÃ¶tÃ¼</span>
                            </button>
                        </div>
                        <div id="moodStatus" style="text-align: center; font-style: italic; color: #666; font-size: 14px;">
                            HenÃ¼z ruh halinizi belirtmediniz
                        </div>
                    </div>

                    <!-- Hava Durumu ve Aktivite -->
                    <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 15px; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">ğŸŒ¤ï¸</span>
                            GÃ¼nlÃ¼k Detaylar
                        </h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="font-size: 14px; color: #666; margin-bottom: 5px; display: block;">Hava Durumu</label>
                                <select id="weather" onchange="saveDailyDetails()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 5px;">
                                    <option value="">SeÃ§iniz</option>
                                    <option value="sunny">â˜€ï¸ GÃ¼neÅŸli</option>
                                    <option value="cloudy">â˜ï¸ Bulutlu</option>
                                    <option value="rainy">ğŸŒ§ï¸ YaÄŸmurlu</option>
                                    <option value="snowy">â„ï¸ KarlÄ±</option>
                                    <option value="stormy">â›ˆï¸ FÄ±rtÄ±nalÄ±</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 14px; color: #666; margin-bottom: 5px; display: block;">Ana Aktivite</label>
                                <select id="mainActivity" onchange="saveDailyDetails()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 5px;">
                                    <option value="">SeÃ§iniz</option>
                                    <option value="work">ğŸ’¼ Ä°ÅŸ</option>
                                    <option value="study">ğŸ“š Ã‡alÄ±ÅŸma</option>
                                    <option value="exercise">ğŸƒâ€â™‚ï¸ Egzersiz</option>
                                    <option value="social">ğŸ‘¥ Sosyal</option>
                                    <option value="rest">ğŸ˜´ Dinlenme</option>
                                    <option value="travel">âœˆï¸ Seyahat</option>
                                    <option value="hobby">ğŸ¨ Hobi</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Motivasyon SÃ¶zÃ¼ -->
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <h4 style="margin-bottom: 10px; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">ğŸ’ª</span>
                            BugÃ¼nÃ¼n Motivasyon SÃ¶zÃ¼
                        </h4>
                        <div id="dailyQuote" style="font-style: italic; font-size: 16px; line-height: 1.5; margin-bottom: 15px;">
                            "BaÅŸarÄ± yolculuÄŸunuzda her gÃ¼n yeni bir adÄ±m atÄ±n."
                        </div>
                        <button onclick="newQuote()" class="btn" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3);">
                            Yeni SÃ¶z Al
                        </button>
                    </div>

                    <!-- Premium Ã–zellikler (Premium kullanÄ±cÄ±lar iÃ§in) -->
                    <div id="premiumFeatures" style="display: none;">
                        
                        <!-- Sosyal Ã–zellikler -->
                        <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px;">
                            <h4 style="color: #333; margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="margin-right: 8px;">ğŸ‘¥</span>
                                Sosyal Ã–zellikler
                            </h4>
                            <div style="display: grid; gap: 10px;">
                                <button onclick="showFriendsModal()" class="btn" style="background: #4caf50;">
                                    <i class="fas fa-users"></i> ArkadaÅŸlarÄ±m
                                </button>
                                <button onclick="showLeaderboard()" class="btn" style="background: #ff9800;">
                                    <i class="fas fa-trophy"></i> Liderlik Tablosu
                                </button>
                                <button onclick="shareAchievement()" class="btn" style="background: #9c27b0;">
                                    <i class="fas fa-share"></i> BaÅŸarÄ±mÄ± PaylaÅŸ
                                </button>
                            </div>
                        </div>

                        <!-- GeliÅŸmiÅŸ Analitik -->
                        <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px;">
                            <h4 style="color: #333; margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="margin-right: 8px;">ğŸ“Š</span>
                                GeliÅŸmiÅŸ Analitik
                            </h4>
                            <div style="display: grid; gap: 10px;">
                                <button onclick="exportPDF()" class="btn" style="background: #f44336;">
                                    <i class="fas fa-file-pdf"></i> PDF Rapor Ä°ndir
                                </button>
                                <button onclick="showAdvancedAnalytics()" class="btn" style="background: #2196F3;">
                                    <i class="fas fa-chart-line"></i> DetaylÄ± Analiz
                                </button>
                                <button onclick="showTrends()" class="btn" style="background: #00bcd4;">
                                    <i class="fas fa-trending-up"></i> Trend Analizi
                                </button>
                            </div>
                        </div>

                        <!-- AI Ã–zellikleri -->
                        <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px;">
                            <h4 style="color: #333; margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="margin-right: 8px;">ğŸ¤–</span>
                                AI Asistan
                            </h4>
                            <div style="display: grid; gap: 10px;">
                                <button onclick="getAIPersonalizedAdvice()" class="btn" style="background: #673ab7;">
                                    <i class="fas fa-robot"></i> KiÅŸisel AI Ã–nerisi
                                </button>
                                <button onclick="optimizeGoals()" class="btn" style="background: #3f51b5;">
                                    <i class="fas fa-magic"></i> Hedef Optimizasyonu
                                </button>
                                <button onclick="predictSuccess()" class="btn" style="background: #009688;">
                                    <i class="fas fa-crystal-ball"></i> BaÅŸarÄ± Tahmini
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">
                    <span class="section-icon">ğŸ¯</span>
                    Hedefler & HatÄ±rlatÄ±cÄ±lar
                </h2>
                
                <!-- AkÄ±llÄ± HatÄ±rlatÄ±cÄ±lar -->
                <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #ff6b6b, #ee5a24); color: white; border-radius: 10px;">
                    <h4 style="margin-bottom: 10px;">â° AkÄ±llÄ± HatÄ±rlatÄ±cÄ±lar</h4>
                    <div style="display: grid; gap: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>GÃ¼nlÃ¼k HatÄ±rlatÄ±cÄ±</span>
                            <label class="switch">
                                <input type="checkbox" id="dailyReminder" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>HaftalÄ±k Rapor</span>
                            <label class="switch">
                                <input type="checkbox" id="weeklyReport" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>Motivasyon MesajlarÄ±</span>
                            <label class="switch">
                                <input type="checkbox" id="motivationMessages" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('today')">BugÃ¼n</div>
                    <div class="tab" onclick="switchTab('selected')">SeÃ§ili GÃ¼n</div>
                </div>

                <div class="tab-content active" id="todayTab">
                    <div class="goals-section">
                        <div class="selected-date">BugÃ¼n: <span id="todayDate"></span></div>
                        
                        <!-- GeliÅŸmiÅŸ Hedef Ekleme Formu -->
                        <div style="margin-bottom: 20px; padding: 15px; background: rgba(33, 150, 243, 0.1); border-radius: 10px;">
                            <h4 style="margin-bottom: 15px; color: #2196F3;">ğŸ¯ Yeni Hedef Ekle</h4>
                            
                            <!-- HÄ±zlÄ± Åablonlar -->
                            <div style="margin-bottom: 15px;">
                                <h5 style="margin-bottom: 10px; color: #666; font-size: 14px;">âš¡ HÄ±zlÄ± Åablonlar</h5>
                                <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                    <button onclick="addTemplateGoal('30 dakika egzersiz yap')" class="template-btn">ğŸƒâ€â™‚ï¸ Egzersiz</button>
                                    <button onclick="addTemplateGoal('Kitap oku')" class="template-btn">ğŸ“š Okuma</button>
                                    <button onclick="addTemplateGoal('Meditasyon yap')" class="template-btn">ğŸ§˜â€â™€ï¸ Meditasyon</button>
                                    <button onclick="addTemplateGoal('Su iÃ§')" class="template-btn">ğŸ’§ Su</button>
                                    <button onclick="addTemplateGoal('Ailemi ara')" class="template-btn">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Aile</button>
                                    <button onclick="addTemplateGoal('Yeni bir ÅŸey Ã¶ÄŸren')" class="template-btn">ğŸ“ Ã–ÄŸrenme</button>
                                </div>
                            </div>
                            
                            <div style="display: grid; gap: 10px;">
                                <input type="text" class="goal-input" placeholder="Hedefinizi yazÄ±n..." id="newGoalInput" onkeypress="handleEnterKey(event)">
                                <select class="goal-input" id="goalCategory" style="background: white;">
                                    <option value="genel">ğŸ“‹ Genel</option>
                                    <option value="is">ğŸ’¼ Ä°ÅŸ</option>
                                    <option value="saglik">ğŸƒâ€â™‚ï¸ SaÄŸlÄ±k</option>
                                    <option value="egitim">ğŸ“š EÄŸitim</option>
                                    <option value="sosyal">ğŸ‘¥ Sosyal</option>
                                    <option value="kisisel">ğŸ§˜â€â™€ï¸ KiÅŸisel</option>
                                    <option value="yaratici">ğŸ¨ YaratÄ±cÄ±</option>
                                    <option value="finans">ğŸ’° Finans</option>
                                </select>
                                
                                <!-- Ã–ncelik Seviyesi -->
                                <select class="goal-input" id="goalPriority" style="background: white;">
                                    <option value="normal">âšª Normal Ã–ncelik</option>
                                    <option value="high">ğŸ”´ YÃ¼ksek Ã–ncelik</option>
                                    <option value="urgent">ğŸš¨ Acil</option>
                                </select>
                                
                                <button class="btn" onclick="addNewGoal()" style="width: 100%;">
                                    <i class="fas fa-plus"></i> Hedef Ekle
                                </button>
                            </div>
                        </div>

                        <!-- Mevcut Hedefler -->
                        <div id="todayGoalsList" style="margin-bottom: 20px;">
                            <!-- Hedefler burada listelenecek -->
                        </div>

                        <button class="btn btn-secondary" onclick="completeToday()">GÃ¼nÃ¼ Tamamla</button>
                    </div>
                </div>

                <div class="tab-content" id="selectedTab">
                    <div class="goals-section">
                        <div class="selected-date">SeÃ§ili GÃ¼n: <span id="selectedDate"></span></div>
                        
                        <!-- SeÃ§ili GÃ¼n Hedef Ekleme -->
                        <div style="margin-bottom: 20px; padding: 15px; background: rgba(33, 150, 243, 0.1); border-radius: 10px;">
                            <h4 style="margin-bottom: 15px; color: #2196F3;">ğŸ¯ SeÃ§ili GÃ¼n Hedefi Ekle</h4>
                            <div style="display: grid; gap: 10px;">
                                <input type="text" class="goal-input" placeholder="Hedefinizi yazÄ±n..." id="selectedGoalInput" onkeypress="handleSelectedEnterKey(event)">
                                <select class="goal-input" id="selectedGoalCategory" style="background: white;">
                                    <option value="genel">ğŸ“‹ Genel</option>
                                    <option value="is">ğŸ’¼ Ä°ÅŸ</option>
                                    <option value="saglik">ğŸƒâ€â™‚ï¸ SaÄŸlÄ±k</option>
                                    <option value="egitim">ğŸ“š EÄŸitim</option>
                                    <option value="sosyal">ğŸ‘¥ Sosyal</option>
                                    <option value="kisisel">ğŸ§˜â€â™€ï¸ KiÅŸisel</option>
                                    <option value="yaratici">ğŸ¨ YaratÄ±cÄ±</option>
                                    <option value="finans">ğŸ’° Finans</option>
                                </select>
                                <select class="goal-input" id="selectedGoalPriority" style="background: white;">
                                    <option value="normal">âšª Normal Ã–ncelik</option>
                                    <option value="high">ğŸ”´ YÃ¼ksek Ã–ncelik</option>
                                    <option value="urgent">ğŸš¨ Acil</option>
                                </select>
                                <button class="btn" onclick="addSelectedGoal()" style="width: 100%;">
                                    <i class="fas fa-plus"></i> Hedef Ekle
                                </button>
                            </div>
                        </div>

                        <!-- SeÃ§ili GÃ¼n Hedefleri Listesi -->
                        <div id="selectedGoalsList" style="margin-bottom: 20px;">
                            <!-- Hedefler burada listelenecek -->
                        </div>

                        <!-- SeÃ§ili GÃ¼n NotlarÄ± -->
                        <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px;">
                            <h4 style="color: #333; margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="margin-right: 8px;">ğŸ“</span>
                                SeÃ§ili GÃ¼n NotlarÄ±
                            </h4>
                            <textarea id="selectedDayNotes" placeholder="Bu gÃ¼n iÃ§in notlarÄ±nÄ±zÄ± yazÄ±n..." style="width: 100%; min-height: 80px; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-family: inherit; resize: vertical;" onchange="saveSelectedNotes()"></textarea>
                            <div style="margin-top: 10px; display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 12px; color: #666;">NotlarÄ±nÄ±z otomatik kaydedilir</span>
                                <button onclick="clearSelectedNotes()" class="btn-secondary" style="padding: 6px 12px; font-size: 12px;">Temizle</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="progress-section">
                    <h3>BugÃ¼nÃ¼n Ä°lerlemesi</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar"></div>
                    </div>
                    <div id="progressText">0/3 hedef tamamlandÄ±</div>
                    
                    <div class="stats">
                        <div class="stat-item">
                            <div class="stat-number" id="totalDays">0</div>
                            <div class="stat-label">Toplam GÃ¼n</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="completedGoals">0</div>
                            <div class="stat-label">Tamamlanan Hedef</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="successRate">0%</div>
                            <div class="stat-label">BaÅŸarÄ± OranÄ±</div>
                        </div>
                    </div>
                    
                    <!-- Gamification Stats -->
                    <div class="stats" style="margin-top: 20px;">
                        <div class="stat-item">
                            <div class="stat-number" id="userPoints">0</div>
                            <div class="stat-label">Toplam Puan</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="userLevel">1</div>
                            <div class="stat-label">Seviye</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="userStreak">0</div>
                            <div class="stat-label">GÃ¼nlÃ¼k Seri</div>
                        </div>
                    </div>
                    
                    <!-- Badges Section -->
                    <div style="margin-top: 20px;">
                        <h3 style="color: #2196F3; margin-bottom: 10px;">ğŸ† Rozetler</h3>
                        <div id="badgesContainer" style="display: flex; flex-wrap: wrap; gap: 10px;">
                            <!-- Badges will be displayed here -->
                        </div>
                    </div>

                    <!-- GeliÅŸmiÅŸ Analitik -->
                    <div style="margin-top: 20px;">
                        <h3 style="color: #2196F3; margin-bottom: 10px;">ğŸ“Š DetaylÄ± Analitik</h3>
                        
                        <!-- HaftalÄ±k Rapor -->
                        <div id="weeklyReport" style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 15px;">
                            <h4 style="margin-bottom: 10px; color: #333;">ğŸ“ˆ HaftalÄ±k Performans</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; text-align: center;">
                                <div>
                                    <div style="font-size: 20px; font-weight: bold; color: #2196F3;" id="weeklyGoals">0</div>
                                    <div style="font-size: 12px; color: #666;">Hedef</div>
                                </div>
                                <div>
                                    <div style="font-size: 20px; font-weight: bold; color: #4caf50;" id="weeklyCompleted">0</div>
                                    <div style="font-size: 12px; color: #666;">Tamamlanan</div>
                                </div>
                                <div>
                                    <div style="font-size: 20px; font-weight: bold; color: #ff9800;" id="weeklyRate">0%</div>
                                    <div style="font-size: 12px; color: #666;">BaÅŸarÄ± OranÄ±</div>
                                </div>
                            </div>
                        </div>

                        <!-- Kategori Analizi -->
                        <div id="categoryAnalysis" style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 15px;">
                            <h4 style="margin-bottom: 10px; color: #333;">ğŸ¯ Kategori DaÄŸÄ±lÄ±mÄ±</h4>
                            <div id="categoryChart" style="height: 200px; display: flex; align-items: end; gap: 5px; padding: 10px 0;">
                                <!-- Kategori grafikleri burada oluÅŸturulacak -->
                            </div>
                        </div>

                        <!-- Zaman Analizi -->
                        <div id="timeAnalysis" style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <h4 style="margin-bottom: 10px; color: #333;">â° En Verimli Saatler</h4>
                            <div id="timeChart" style="height: 150px; display: flex; align-items: end; gap: 2px; padding: 10px 0;">
                                <!-- Zaman grafikleri burada oluÅŸturulacak -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global deÄŸiÅŸkenler
        let currentDate = new Date();
        let selectedDate = new Date();
        let currentUser = null;
        let userPlan = 'free'; // 'free' veya 'premium'
        let goals = {};
        let completedDays = {};
        let dailyNotes = {};
        let dailyMoods = {};
        let dailyDetails = {};
        let userStats = {
            points: 0,
            level: 1,
            badges: [],
            streak: 0,
            premiumFeatures: []
        };
        let friends = [];
        let socialActivities = [];
        let premiumExpiry = null;

        // Motivasyon sÃ¶zleri
        const motivationalQuotes = [
            "BaÅŸarÄ± yolculuÄŸunuzda her gÃ¼n yeni bir adÄ±m atÄ±n.",
            "KÃ¼Ã§Ã¼k hedefler bÃ¼yÃ¼k baÅŸarÄ±larÄ±n temelidir.",
            "BugÃ¼n yapabileceÄŸinizi yarÄ±na bÄ±rakmayÄ±n.",
            "Her gÃ¼n yeni bir baÅŸlangÄ±Ã§tÄ±r.",
            "Motivasyonunuz yÃ¼ksek, hedefleriniz net.",
            "BaÅŸarÄ± iÃ§in gerekli olan tek ÅŸey bugÃ¼n baÅŸlamak.",
            "Hedeflerinize ulaÅŸmak iÃ§in mÃ¼kemmel bir gÃ¼n.",
            "Her gÃ¼n bir fÄ±rsat, bugÃ¼n sizin fÄ±rsatÄ±nÄ±z.",
            "BaÅŸarÄ± yolculuÄŸunuzda bugÃ¼n Ã¶nemli bir adÄ±m.",
            "KÃ¼Ã§Ã¼k ilerlemeler bÃ¼yÃ¼k deÄŸiÅŸimler yaratÄ±r."
        ];

        // KullanÄ±cÄ± yÃ¶netimi
        function checkAuth() {
            // Eski kullanÄ±cÄ± verilerini temizle (yeni sistem iÃ§in)
            localStorage.removeItem('miniplan_user');
            localStorage.removeItem('miniplan_users');
            
            // Her zaman kullanÄ±cÄ± kurulum modalÄ±nÄ± gÃ¶ster
            showUserSetupModal();
        }

        function loadUserData() {
            // TÃ¼m deÄŸiÅŸkenleri gÃ¼venli ÅŸekilde baÅŸlat
            goals = goals || {};
            completedDays = completedDays || {};
            dailyNotes = dailyNotes || {};
            dailyMoods = dailyMoods || {};
            dailyDetails = dailyDetails || {};
            friends = friends || [];
            userPlan = userPlan || 'free';
            premiumExpiry = premiumExpiry || null;
            
            if (!userStats) {
                userStats = {
                    points: 0,
                    level: 1,
                    badges: [],
                    streak: 0,
                    premiumFeatures: []
                };
            }
            
            // currentUser kontrolÃ¼
            if (!currentUser) {
                console.log('currentUser yok, varsayÄ±lan deÄŸerler yÃ¼kleniyor');
                return;
            }
            
            const userGoals = localStorage.getItem(`miniplan_goals_${currentUser.id}`) || '{}';
            const userCompletedDays = localStorage.getItem(`miniplan_completedDays_${currentUser.id}`) || '{}';
            const userStatsData = localStorage.getItem(`miniplan_userStats_${currentUser.id}`) || '{}';
            const userNotes = localStorage.getItem(`miniplan_notes_${currentUser.id}`) || '{}';
            const userMoods = localStorage.getItem(`miniplan_moods_${currentUser.id}`) || '{}';
            const userDetails = localStorage.getItem(`miniplan_details_${currentUser.id}`) || '{}';
            const userPlanData = localStorage.getItem(`miniplan_plan_${currentUser.id}`) || 'free';
            const userPremiumExpiry = localStorage.getItem(`miniplan_premium_expiry_${currentUser.id}`) || null;
            const userFriends = localStorage.getItem(`miniplan_friends_${currentUser.id}`) || '[]';
            
            goals = JSON.parse(userGoals);
            completedDays = JSON.parse(userCompletedDays);
            userStats = JSON.parse(userStatsData);
            dailyNotes = JSON.parse(userNotes);
            dailyMoods = JSON.parse(userMoods);
            dailyDetails = JSON.parse(userDetails);
            userPlan = userPlanData;
            premiumExpiry = userPremiumExpiry ? new Date(userPremiumExpiry) : null;
            friends = JSON.parse(userFriends);
        }

        function saveUserData() {
            if (!currentUser) return;
            
            localStorage.setItem(`miniplan_goals_${currentUser.id}`, JSON.stringify(goals));
            localStorage.setItem(`miniplan_completedDays_${currentUser.id}`, JSON.stringify(completedDays));
            localStorage.setItem(`miniplan_userStats_${currentUser.id}`, JSON.stringify(userStats));
            localStorage.setItem(`miniplan_notes_${currentUser.id}`, JSON.stringify(dailyNotes));
            localStorage.setItem(`miniplan_moods_${currentUser.id}`, JSON.stringify(dailyMoods));
            localStorage.setItem(`miniplan_details_${currentUser.id}`, JSON.stringify(dailyDetails));
            localStorage.setItem(`miniplan_plan_${currentUser.id}`, userPlan);
            localStorage.setItem(`miniplan_premium_expiry_${currentUser.id}`, premiumExpiry ? premiumExpiry.toISOString() : null);
            localStorage.setItem(`miniplan_friends_${currentUser.id}`, JSON.stringify(friends));
        }

        // AI Motivasyon CÃ¼mleleri
        const motivationMessages = [
            "BugÃ¼n harika bir gÃ¼n olacak! Her adÄ±mÄ±nÄ±z baÅŸarÄ±ya gÃ¶tÃ¼rÃ¼yor. ğŸŒŸ",
            "Yeni bir gÃ¼n, yeni fÄ±rsatlar! Hedeflerinize odaklanÄ±n ve ilerleyin. ğŸ’ª",
            "BaÅŸarÄ± yolculuÄŸunuzda bugÃ¼n Ã¶nemli bir adÄ±m atacaksÄ±nÄ±z. ğŸš€",
            "KÃ¼Ã§Ã¼k hedefler bÃ¼yÃ¼k baÅŸarÄ±larÄ±n temelidir. BugÃ¼n mÃ¼kemmel! âœ¨",
            "Motivasyonunuz yÃ¼ksek, hedefleriniz net. BugÃ¼n sizin gÃ¼nÃ¼nÃ¼z! ğŸ¯",
            "Her gÃ¼n yeni bir baÅŸlangÄ±Ã§. BugÃ¼n fark yaratacaksÄ±nÄ±z! ğŸŒ…",
            "Hedeflerinize ulaÅŸmak iÃ§in bugÃ¼n mÃ¼kemmel bir gÃ¼n. BaÅŸlayÄ±n! ğŸ”¥",
            "BaÅŸarÄ± iÃ§in gerekli olan tek ÅŸey bugÃ¼n baÅŸlamak. HazÄ±rsÄ±nÄ±z! â­",
            "BugÃ¼n hedeflerinize bir adÄ±m daha yaklaÅŸacaksÄ±nÄ±z. Ä°nanÄ±n! ğŸ’",
            "Her gÃ¼n bir fÄ±rsat, bugÃ¼n sizin fÄ±rsatÄ±nÄ±z. DeÄŸerlendirin! ğŸª"
        ];

        // KullanÄ±cÄ± kurulum fonksiyonlarÄ±
        function showUserSetupModal() {
            document.getElementById('userSetupModal').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
        }

        function createUser() {
            const userName = document.getElementById('userNameInput').value.trim();
            
            if (!userName) {
                alert('Lutfen kullanici adinizi girin!');
                return;
            }
            
            // KullanÄ±cÄ± adÄ± uzunluÄŸunu kontrol et
            if (userName.length < 2) {
                alert('Kullanici adi en az 2 karakter olmalidir!');
                return;
            }
            
            if (userName.length > 20) {
                alert('Kullanici adi en fazla 20 karakter olabilir!');
                return;
            }
            
            // Yeni kullanÄ±cÄ± oluÅŸtur
            currentUser = {
                id: Date.now(),
                name: userName,
                createdAt: new Date()
            };
            
            // KullanÄ±cÄ±yÄ± kaydet
            localStorage.setItem('miniplan_user', JSON.stringify(currentUser));
            
            // TÃ¼m deÄŸiÅŸkenleri sÄ±fÄ±rla
            goals = {};
            completedDays = {};
            dailyNotes = {};
            dailyMoods = {};
            dailyDetails = {};
            friends = [];
            userStats = {
                points: 0,
                level: 1,
                badges: [],
                streak: 0,
                premiumFeatures: []
            };
            userPlan = 'free';
            premiumExpiry = null;
            
            // KullanÄ±cÄ± verilerini yÃ¼kle
            loadUserData();
            
            // Ana uygulamayÄ± gÃ¶ster
            showMainApp();
            
            alert('Hos geldiniz, ' + userName + '! ğŸ‰');
        }

        function showMainApp() {
            console.log('showMainApp fonksiyonu Ã§alÄ±ÅŸtÄ±');
            console.log('currentUser:', currentUser);
            
            const userSetupModal = document.getElementById('userSetupModal');
            const mainApp = document.getElementById('mainApp');
            const userName = document.getElementById('userName');
            
            console.log('userSetupModal:', userSetupModal);
            console.log('mainApp:', mainApp);
            console.log('userName:', userName);
            
            if (userSetupModal) userSetupModal.style.display = 'none';
            if (mainApp) mainApp.style.display = 'block';
            if (userName && currentUser) userName.textContent = currentUser.name;
            
            console.log('initializeApp Ã§aÄŸrÄ±lÄ±yor');
            initializeApp();
            console.log('showMainApp tamamlandÄ±');
        }



        function logout() {
            currentUser = null;
            localStorage.removeItem('miniplan_user');
            showUserSetupModal();
            alert('Cikis yapildi');
        }

        // LocalStorage desteÄŸi
        function saveToLocalStorage() {
            if (currentUser) {
                saveUserData();
            }
        }

        function loadFromLocalStorage() {
            if (currentUser) {
                loadUserData();
            }
        }

        // Mobil optimizasyonlarÄ±
        function setupMobileOptimizations() {
            // iOS Safari iÃ§in viewport dÃ¼zeltmesi
            if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                const viewport = document.querySelector('meta[name=viewport]');
                if (viewport) {
                    viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover');
                }
            }
            
            // Android Chrome iÃ§in touch optimizasyonu
            if (/Android/.test(navigator.userAgent)) {
                document.body.style.touchAction = 'manipulation';
            }
            
            // PWA install prompt
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                showInstallPrompt();
            });
        }
        
        function showInstallPrompt() {
            // PWA kurulum Ã¶nerisi gÃ¶sterme
            console.log('PWA kurulum Ã¶nerisi mevcut');
        }
        
        // Service Worker kaydet
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker baÅŸarÄ±yla kaydedildi:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('ServiceWorker kaydÄ± baÅŸarÄ±sÄ±z:', error);
                    });
            });
        }

        // Sayfa yÃ¼klendiÄŸinde auth kontrolÃ¼ yap
        window.addEventListener('load', function() {
            setupMobileOptimizations();
            checkAuth();
            loadThemeSettings();
        });

        // Ana uygulama yÃ¼klendiÄŸinde
        function initializeApp() {
            console.log('initializeApp baÅŸladÄ±');
            try {
                // TÃ¼m deÄŸiÅŸkenleri gÃ¼venli ÅŸekilde baÅŸlat
                if (!goals) goals = {};
                if (!completedDays) completedDays = {};
                if (!dailyNotes) dailyNotes = {};
                if (!dailyMoods) dailyMoods = {};
                if (!dailyDetails) dailyDetails = {};
                if (!friends) friends = [];
                if (!userStats) {
                    userStats = {
                        points: 0,
                        level: 1,
                        badges: [],
                        streak: 0,
                        premiumFeatures: []
                    };
                }
                if (!userPlan) userPlan = 'free';
                
                // KullanÄ±cÄ± verilerini yÃ¼kle
                loadUserData();
                console.log('loadUserData tamamlandÄ±');
                
                loadFromLocalStorage();
                console.log('loadFromLocalStorage tamamlandÄ±');
                
                renderCalendar();
                console.log('renderCalendar tamamlandÄ±');
                
                updateStats();
                console.log('updateStats tamamlandÄ±');
                
                updateAnalytics();
                console.log('updateAnalytics tamamlandÄ±');
                
                displayBadges();
                console.log('displayBadges tamamlandÄ±');
                
                generateAISuggestions();
                console.log('generateAISuggestions tamamlandÄ±');
                
                updateTodayDate();
                console.log('updateTodayDate tamamlandÄ±');
                
                setupNotifications();
                console.log('setupNotifications tamamlandÄ±');
                
                scheduleReminder();
                console.log('scheduleReminder tamamlandÄ±');
                
                loadTodayGoals();
                console.log('loadTodayGoals tamamlandÄ±');
                
                loadNotes();
                console.log('loadNotes tamamlandÄ±');
                
                loadMood();
                console.log('loadMood tamamlandÄ±');
                
                loadDailyDetails();
                console.log('loadDailyDetails tamamlandÄ±');
                
                loadQuote();
                console.log('loadQuote tamamlandÄ±');
                
                updatePremiumStatus();
                console.log('updatePremiumStatus tamamlandÄ±');
                
                loadPremiumFeatures();
                console.log('loadPremiumFeatures tamamlandÄ±');
                
                console.log('initializeApp tamamlandÄ±');
            } catch (error) {
                console.error('initializeApp hatasÄ±:', error);
                alert('Uygulama baslatilirken hata olustu: ' + error.message);
            }
        }

        // Bildirim sistemi
        function sendNotification(title, body) {
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification(title, {
                    body: body,
                    icon: '/favicon.ico',
                    badge: '/favicon.ico'
                });
            }
        }

        function scheduleReminder() {
            const now = new Date();
            const reminderTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 20, 0, 0); // Saat 20:00
            
            if (now < reminderTime) {
                const timeUntilReminder = reminderTime.getTime() - now.getTime();
                setTimeout(() => {
                    sendNotification('MiniPlan HatÄ±rlatÄ±cÄ±', 'GÃ¼nlÃ¼k hedeflerinizi kontrol etmeyi unutmayÄ±n! ğŸ¯');
                }, timeUntilReminder);
            }
        }

        // Veri deÄŸiÅŸtiÄŸinde otomatik kaydet
        function autoSave() {
            saveToLocalStorage();
        }

        // Tema fonksiyonlarÄ±
        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            body.setAttribute('data-theme', newTheme);
            localStorage.setItem('miniplan_theme', newTheme);
            
            const icon = document.querySelector('.theme-toggle i');
            icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            
            showNotification('Tema deÄŸiÅŸtirildi!');
        }

        function changeColor(color) {
            document.body.setAttribute('data-color', color);
            localStorage.setItem('miniplan_color', color);
            showNotification('Renk temasÄ± deÄŸiÅŸtirildi!');
        }

        function loadThemeSettings() {
            const savedTheme = localStorage.getItem('miniplan_theme') || 'light';
            const savedColor = localStorage.getItem('miniplan_color') || 'blue';
            
            document.body.setAttribute('data-theme', savedTheme);
            document.body.setAttribute('data-color', savedColor);
            
            const icon = document.querySelector('.theme-toggle i');
            icon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            
            document.querySelector('.color-picker').value = savedColor;
        }

        function showNotification(message) {
            alert(message);
        }

        function setupNotifications() {
            if ('Notification' in window) {
                Notification.requestPermission();
            }
        }

        // AI Motivasyon gÃ¼ncelleme
        function updateAIMotivation() {
            const today = new Date().toDateString();
            const dayIndex = new Date().getDate() % motivationMessages.length;
            const message = motivationMessages[dayIndex];
            document.getElementById('aiMotivation').textContent = message;
        }

        // Takvim render
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            document.getElementById('calendarTitle').textContent = 
                new Date(year, month).toLocaleDateString('tr-TR', { month: 'long', year: 'numeric' });

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            let calendarHTML = '';
            
            // Hafta baÅŸlÄ±klarÄ±
            const weekdays = ['Pzt', 'Sal', 'Ã‡ar', 'Per', 'Cum', 'Cmt', 'Paz'];
            weekdays.forEach(day => {
                calendarHTML += `<div class="weekday-header">${day}</div>`;
            });

            // Takvim gÃ¼nleri
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const isCurrentMonth = date.getMonth() === month;
                const isToday = date.toDateString() === new Date().toDateString();
                const hasGoals = goals[date.toDateString()] && goals[date.toDateString()].length > 0;
                
                let className = 'calendar-day';
                if (!isCurrentMonth) className += ' other-month';
                if (isToday) className += ' today';
                if (hasGoals) className += ' has-goals';
                
                calendarHTML += `
                    <div class="${className}" onclick="selectDate('${date.toDateString()}')">
                        ${date.getDate()}
                    </div>
                `;
            }

            document.getElementById('calendarGrid').innerHTML = calendarHTML;
        }

        // Tarih seÃ§me
        function selectDate(dateString) {
            selectedDate = new Date(dateString);
            document.getElementById('selectedDate').textContent = 
                selectedDate.toLocaleDateString('tr-TR', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            
            loadSelectedGoals();
            loadSelectedNotes();
            switchTab('selected');
        }

        // Tab deÄŸiÅŸtirme
        function switchTab(tabName) {
            // Tab butonlarÄ±nÄ± gÃ¼ncelle
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tabName === 'today') {
                document.querySelector('.tab:first-child').classList.add('active');
                document.getElementById('todayTab').classList.add('active');
            } else {
                document.querySelector('.tab:last-child').classList.add('active');
                document.getElementById('selectedTab').classList.add('active');
            }
        }

        // Åablon hedef ekleme
        function addTemplateGoal(templateText) {
            document.getElementById('newGoalInput').value = templateText;
            // Otomatik kategori seÃ§imi
            if (templateText.includes('egzersiz') || templateText.includes('su')) {
                document.getElementById('goalCategory').value = 'saglik';
            } else if (templateText.includes('kitap') || templateText.includes('Ã¶ÄŸren')) {
                document.getElementById('goalCategory').value = 'egitim';
            } else if (templateText.includes('meditasyon')) {
                document.getElementById('goalCategory').value = 'kisisel';
            } else if (templateText.includes('aile')) {
                document.getElementById('goalCategory').value = 'sosyal';
            }
        }

        // Yeni hedef ekleme fonksiyonu
        function addNewGoal() {
            const goalInput = document.getElementById('newGoalInput');
            const categorySelect = document.getElementById('goalCategory');
            const prioritySelect = document.getElementById('goalPriority');
            const goalText = goalInput.value.trim();
            const category = categorySelect.value;
            const priority = prioritySelect.value;
            
            if (goalText) {
                // Premium kontrolÃ¼
                if (!checkGoalLimit()) {
                    return;
                }
                
                const today = new Date().toDateString();
                if (!goals[today]) {
                    goals[today] = [];
                }
                
                const newGoal = {
                    id: Date.now(),
                    text: goalText,
                    category: category,
                    priority: priority,
                    completed: false,
                    createdAt: new Date(),
                    completedAt: null
                };
                
                goals[today].push(newGoal);
                goalInput.value = '';
                
                displayTodayGoals();
                updateProgress();
                updateAnalytics();
                addPoints(10);
                autoSave();
                alert('Hedef eklendi! ğŸ¯');
            }
        }

        // BugÃ¼nÃ¼n hedeflerini gÃ¶rÃ¼ntÃ¼le
        function displayTodayGoals() {
            const today = new Date().toDateString();
            const todayGoals = goals[today] || [];
            const container = document.getElementById('todayGoalsList');
            
            if (todayGoals.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">HenÃ¼z hedef eklenmemiÅŸ</p>';
                return;
            }
            
            // Hedefleri Ã¶nceliÄŸe gÃ¶re sÄ±rala
            const sortedGoals = todayGoals.sort((a, b) => {
                const priorityOrder = { urgent: 3, high: 2, normal: 1 };
                return priorityOrder[b.priority] - priorityOrder[a.priority];
            });
            
            container.innerHTML = sortedGoals.map(goal => {
                const priorityClass = goal.priority === 'high' ? 'priority-high' : 
                                    goal.priority === 'urgent' ? 'priority-urgent' : '';
                const priorityIcon = goal.priority === 'high' ? 'ğŸ”´' : 
                                   goal.priority === 'urgent' ? 'ğŸš¨' : 'âšª';
                
                return `
                    <div class="${priorityClass}" style="display: flex; align-items: center; gap: 10px; padding: 10px; background: white; border-radius: 8px; margin-bottom: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <input type="checkbox" ${goal.completed ? 'checked' : ''} onchange="toggleGoal(${goal.id})" style="transform: scale(1.2);">
                        <span style="flex: 1; ${goal.completed ? 'text-decoration: line-through; color: #666;' : ''}">${goal.text}</span>
                        <span style="font-size: 12px; color: #2196F3; background: rgba(33, 150, 243, 0.1); padding: 2px 8px; border-radius: 12px;">${getCategoryIcon(goal.category)}</span>
                        <span style="font-size: 12px;" title="Ã–ncelik">${priorityIcon}</span>
                        <button onclick="deleteGoal(${goal.id})" style="background: #f44336; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">Sil</button>
                    </div>
                `;
            }).join('');
        }

        // Kategori ikonlarÄ±
        function getCategoryIcon(category) {
            const icons = {
                'genel': 'ğŸ“‹',
                'is': 'ğŸ’¼',
                'saglik': 'ğŸƒâ€â™‚ï¸',
                'egitim': 'ğŸ“š',
                'sosyal': 'ğŸ‘¥',
                'kisisel': 'ğŸ§˜â€â™€ï¸',
                'yaratici': 'ğŸ¨',
                'finans': 'ğŸ’°'
            };
            return icons[category] || 'ğŸ“‹';
        }

        // Hedef durumunu deÄŸiÅŸtir
        function toggleGoal(goalId) {
            const today = new Date().toDateString();
            const todayGoals = goals[today] || [];
            const goal = todayGoals.find(g => g.id === goalId);
            
            if (goal) {
                goal.completed = !goal.completed;
                if (goal.completed) {
                    goal.completedAt = new Date();
                    addPoints(5);
                    showNotification('Hedef tamamlandÄ±! +5 puan ğŸ‰');
                } else {
                    goal.completedAt = null;
                }
                displayTodayGoals();
                updateProgress();
                updateAnalytics();
                autoSave();
            }
        }

        // Hedef sil
        function deleteGoal(goalId) {
            const today = new Date().toDateString();
            goals[today] = goals[today].filter(g => g.id !== goalId);
            displayTodayGoals();
            updateProgress();
            autoSave();
            showNotification('Hedef silindi');
        }

        // Enter tuÅŸu ile hedef ekleme
        function handleEnterKey(event) {
            if (event.key === 'Enter') {
                addNewGoal();
            }
        }

        // Not yÃ¶netimi
        function saveNotes() {
            const today = new Date().toDateString();
            const notes = document.getElementById('dailyNotes').value;
            dailyNotes[today] = notes;
            autoSave();
        }

        function clearNotes() {
            document.getElementById('dailyNotes').value = '';
            saveNotes();
        }

        function loadNotes() {
            const today = new Date().toDateString();
            const notes = dailyNotes[today] || '';
            document.getElementById('dailyNotes').value = notes;
        }

        // SeÃ§ili gÃ¼n notlarÄ±
        function saveSelectedNotes() {
            const dateString = selectedDate.toDateString();
            const notes = document.getElementById('selectedDayNotes').value;
            dailyNotes[dateString] = notes;
            autoSave();
        }

        function clearSelectedNotes() {
            document.getElementById('selectedDayNotes').value = '';
            saveSelectedNotes();
        }

        function loadSelectedNotes() {
            const dateString = selectedDate.toDateString();
            const notes = dailyNotes[dateString] || '';
            document.getElementById('selectedDayNotes').value = notes;
        }

        // Ruh hali yÃ¶netimi
        function setMood(mood) {
            const today = new Date().toDateString();
            dailyMoods[today] = mood;
            
            // TÃ¼m mood butonlarÄ±ndan selected class'Ä±nÄ± kaldÄ±r
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // SeÃ§ilen butona selected class'Ä±nÄ± ekle
            document.querySelector(`[data-mood="${mood}"]`).classList.add('selected');
            
            const moodTexts = {
                'excellent': 'BugÃ¼n kendinizi mÃ¼kemmel hissediyorsunuz! ğŸ˜„',
                'good': 'BugÃ¼n kendinizi iyi hissediyorsunuz! ğŸ˜Š',
                'okay': 'BugÃ¼n kendinizi normal hissediyorsunuz! ğŸ˜',
                'bad': 'BugÃ¼n kendinizi kÃ¶tÃ¼ hissediyorsunuz! ğŸ˜”',
                'terrible': 'BugÃ¼n kendinizi Ã§ok kÃ¶tÃ¼ hissediyorsunuz! ğŸ˜¢'
            };
            
            document.getElementById('moodStatus').textContent = moodTexts[mood];
            autoSave();
        }

        function loadMood() {
            const today = new Date().toDateString();
            const mood = dailyMoods[today];
            
            if (mood) {
                setMood(mood);
            }
        }

        // GÃ¼nlÃ¼k detaylar
        function saveDailyDetails() {
            const today = new Date().toDateString();
            const weather = document.getElementById('weather').value;
            const activity = document.getElementById('mainActivity').value;
            
            dailyDetails[today] = { weather, activity };
            autoSave();
        }

        function loadDailyDetails() {
            const today = new Date().toDateString();
            const details = dailyDetails[today] || {};
            
            document.getElementById('weather').value = details.weather || '';
            document.getElementById('mainActivity').value = details.activity || '';
        }

        // Motivasyon sÃ¶zÃ¼
        function newQuote() {
            const randomQuote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
            document.getElementById('dailyQuote').textContent = `"${randomQuote}"`;
        }

        function loadQuote() {
            const today = new Date().toDateString();
            const dayIndex = new Date().getDate() % motivationalQuotes.length;
            const quote = motivationalQuotes[dayIndex];
            document.getElementById('dailyQuote').textContent = `"${quote}"`;
        }

        // SeÃ§ili gÃ¼n hedef yÃ¶netimi
        function addSelectedGoal() {
            const goalInput = document.getElementById('selectedGoalInput');
            const categorySelect = document.getElementById('selectedGoalCategory');
            const prioritySelect = document.getElementById('selectedGoalPriority');
            const goalText = goalInput.value.trim();
            const category = categorySelect.value;
            const priority = prioritySelect.value;
            
            if (goalText) {
                const dateString = selectedDate.toDateString();
                if (!goals[dateString]) {
                    goals[dateString] = [];
                }
                
                const newGoal = {
                    id: Date.now(),
                    text: goalText,
                    category: category,
                    priority: priority,
                    completed: false,
                    createdAt: new Date(),
                    completedAt: null
                };
                
                goals[dateString].push(newGoal);
                goalInput.value = '';
                
                displaySelectedGoals();
                updateProgress();
                updateAnalytics();
                addPoints(10);
                autoSave();
                alert('Hedef eklendi! ğŸ¯');
            }
        }

        function displaySelectedGoals() {
            const dateString = selectedDate.toDateString();
            const selectedGoals = goals[dateString] || [];
            const container = document.getElementById('selectedGoalsList');
            
            if (selectedGoals.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">Bu gÃ¼n iÃ§in henÃ¼z hedef eklenmemiÅŸ</p>';
                return;
            }
            
            // Hedefleri Ã¶nceliÄŸe gÃ¶re sÄ±rala
            const sortedGoals = selectedGoals.sort((a, b) => {
                const priorityOrder = { urgent: 3, high: 2, normal: 1 };
                return priorityOrder[b.priority] - priorityOrder[a.priority];
            });
            
            container.innerHTML = sortedGoals.map(goal => {
                const priorityClass = goal.priority === 'high' ? 'priority-high' : 
                                    goal.priority === 'urgent' ? 'priority-urgent' : '';
                const priorityIcon = goal.priority === 'high' ? 'ğŸ”´' : 
                                   goal.priority === 'urgent' ? 'ğŸš¨' : 'âšª';
                
                return `
                    <div class="selected-day-goal ${goal.completed ? 'completed' : ''} ${priorityClass}">
                        <input type="checkbox" ${goal.completed ? 'checked' : ''} onchange="toggleSelectedGoal(${goal.id})" style="transform: scale(1.2);">
                        <span style="flex: 1;">${goal.text}</span>
                        <span style="font-size: 12px; color: #2196F3; background: rgba(33, 150, 243, 0.1); padding: 2px 8px; border-radius: 12px;">${getCategoryIcon(goal.category)}</span>
                        <span style="font-size: 12px;" title="Ã–ncelik">${priorityIcon}</span>
                        <button onclick="deleteSelectedGoal(${goal.id})" style="background: #f44336; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">Sil</button>
                    </div>
                `;
            }).join('');
        }

        function toggleSelectedGoal(goalId) {
            const dateString = selectedDate.toDateString();
            const selectedGoals = goals[dateString] || [];
            const goal = selectedGoals.find(g => g.id === goalId);
            
            if (goal) {
                goal.completed = !goal.completed;
                if (goal.completed) {
                    goal.completedAt = new Date();
                    addPoints(5);
                    showNotification('Hedef tamamlandÄ±! +5 puan ğŸ‰');
                } else {
                    goal.completedAt = null;
                }
                displaySelectedGoals();
                updateProgress();
                updateAnalytics();
                autoSave();
            }
        }

        function deleteSelectedGoal(goalId) {
            const dateString = selectedDate.toDateString();
            goals[dateString] = goals[dateString].filter(g => g.id !== goalId);
            displaySelectedGoals();
            updateProgress();
            updateAnalytics();
            autoSave();
            showNotification('Hedef silindi');
        }

        function handleSelectedEnterKey(event) {
            if (event.key === 'Enter') {
                addSelectedGoal();
            }
        }

        // Premium Plan YÃ¶netimi
        function showPremiumModal() {
            document.getElementById('premiumModal').style.display = 'flex';
        }

        function closePremiumModal() {
            document.getElementById('premiumModal').style.display = 'none';
        }

        function selectFreePlan() {
            userPlan = 'free';
            updatePremiumStatus();
            closePremiumModal();
            alert('Ãœcretsiz plan seÃ§ildi');
        }

        function selectPremiumPlan() {
            userPlan = 'premium';
            premiumExpiry = new Date();
            premiumExpiry.setMonth(premiumExpiry.getMonth() + 1); // 1 ay premium
            updatePremiumStatus();
            closePremiumModal();
            alert('Premium plana hos geldiniz! ğŸ‰');
            loadPremiumFeatures();
        }

        function updatePremiumStatus() {
            const statusElement = document.getElementById('premiumStatus');
            const btnElement = document.getElementById('premiumBtn');
            
            if (userPlan === 'premium') {
                statusElement.textContent = 'ğŸ’';
                btnElement.classList.add('premium');
            } else {
                statusElement.textContent = 'ğŸ†“';
                btnElement.classList.remove('premium');
            }
            
            // Premium Ã¶zellikleri gÃ¶ster/gizle
            const premiumFeatures = document.getElementById('premiumFeatures');
            if (userPlan === 'premium') {
                premiumFeatures.style.display = 'block';
            } else {
                premiumFeatures.style.display = 'none';
            }
        }

        function loadPremiumFeatures() {
            if (userPlan === 'premium') {
                document.getElementById('premiumFeatures').style.display = 'block';
            }
        }

        // Premium Ã¶zellik kontrolÃ¼
        function checkPremiumFeature(featureName) {
            if (userPlan !== 'premium') {
                alert('Bu ozellik Premium plana ozeldir! ğŸ’');
                showPremiumModal();
                return false;
            }
            return true;
        }

        // Hedef limiti kontrolÃ¼ (Ã¼cretsiz kullanÄ±cÄ±lar iÃ§in)
        function checkGoalLimit() {
            // goals objesinin yÃ¼klendiÄŸinden emin ol
            if (!goals) {
                goals = {};
            }
            
            if (userPlan === 'free') {
                const today = new Date().toDateString();
                const todayGoals = goals[today] || [];
                if (todayGoals.length >= 5) {
                    alert('Ucretsiz planda gunde maksimum 5 hedef ekleyebilirsiniz. Premium\'a gecin! ğŸ’');
                    showPremiumModal();
                    return false;
                }
            }
            return true;
        }

        // Sosyal Ã–zellikler
        function showFriendsModal() {
            console.log('showFriendsModal Ã§aÄŸrÄ±ldÄ±');
            
            // Premium kontrolÃ¼ kaldÄ±rÄ±ldÄ± - herkes kullanabilir
            // if (!checkPremiumFeature('friends')) return;
            
            // ArkadaÅŸ listesini gÃ¼ncelle
            updateFriendsList();
            
            // KullanÄ±cÄ± kodunu gÃ¶ster
            const myCodeElement = document.getElementById('myCode');
            if (myCodeElement && currentUser) {
                myCodeElement.value = currentUser.id;
                console.log('KullanÄ±cÄ± kodu ayarlandÄ±:', currentUser.id);
            } else {
                console.log('myCodeElement veya currentUser bulunamadÄ±');
            }
            
            // Modal'Ä± gÃ¶ster
            const friendsModal = document.getElementById('friendsModal');
            if (friendsModal) {
                friendsModal.style.display = 'flex';
                console.log('ArkadaÅŸ modalÄ± gÃ¶sterildi');
            } else {
                console.error('friendsModal elementi bulunamadÄ±');
            }
        }

        function closeFriendsModal() {
            const friendsModal = document.getElementById('friendsModal');
            if (friendsModal) {
                friendsModal.style.display = 'none';
            }
        }

        function addFriend() {
            const friendNameInput = document.getElementById('friendNameInput');
            const friendCodeInput = document.getElementById('friendCodeInput');
            
            if (!friendNameInput || !friendCodeInput) {
                alert('Form elementleri bulunamadi!');
                return;
            }
            
            const friendName = friendNameInput.value.trim();
            const friendCode = friendCodeInput.value.trim();
            
            if (!friendName || !friendCode) {
                alert('Lutfen arkadas adi ve kodunu girin!');
                return;
            }
            
            // Kendini eklemeye Ã§alÄ±ÅŸÄ±yor mu kontrol et
            if (friendCode == currentUser.id) {
                alert('Kendinizi arkadas olarak ekleyemezsiniz!');
                return;
            }
            
            // ArkadaÅŸ zaten var mÄ± kontrol et
            if (friends.find(f => f.id == friendCode)) {
                alert('Bu arkadas zaten listenizde!');
                return;
            }
            
            // Yeni arkadaÅŸ ekle
            const newFriend = {
                id: friendCode,
                name: friendName,
                addedAt: new Date()
            };
            
            friends.push(newFriend);
            saveUserData();
            
            // Form'u temizle
            friendNameInput.value = '';
            friendCodeInput.value = '';
            
            // Listeyi gÃ¼ncelle
            updateFriendsList();
            
            alert('Arkadas eklendi: ' + friendName + '! ğŸ‘¥');
        }

        function updateFriendsList() {
            const friendsList = document.getElementById('friendsList');
            if (!friendsList) {
                console.error('friendsList elementi bulunamadi');
                return;
            }
            
            friendsList.innerHTML = '';
            
            if (!friends || friends.length === 0) {
                friendsList.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">Henuz arkadasiniz yok</p>';
                return;
            }
            
            friends.forEach(friend => {
                const friendDiv = document.createElement('div');
                friendDiv.style.cssText = `
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 10px;
                    background: #f8f9fa;
                    border-radius: 8px;
                    margin-bottom: 8px;
                `;
                
                friendDiv.innerHTML = `
                    <div>
                        <strong>${friend.name}</strong>
                        <br>
                        <small style="color: #666;">Eklenme: ${new Date(friend.addedAt).toLocaleDateString()}</small>
                    </div>
                    <button onclick="removeFriend('${friend.id}')" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">
                        KaldÄ±r
                    </button>
                `;
                
                friendsList.appendChild(friendDiv);
            });
        }

        function removeFriend(friendId) {
            friends = friends.filter(f => f.id !== friendId);
            saveUserData();
            updateFriendsList();
            alert('Arkadas kaldirildi!');
        }

        function copyMyCode() {
            const codeInput = document.getElementById('myCode');
            if (!codeInput) {
                alert('Kod alani bulunamadi!');
                return;
            }
            
            codeInput.select();
            codeInput.setSelectionRange(0, 99999); // Mobil iÃ§in
            
            try {
                document.execCommand('copy');
                alert('Kod kopyalandi! Arkadaslarinizla paylasabilirsiniz.');
            } catch (err) {
                alert('Kopyalama basarisiz! Manuel olarak kopyalayin.');
            }
        }

        function showLeaderboard() {
            if (!checkPremiumFeature('leaderboard')) return;
            alert('Liderlik tablosu yakinda! ğŸ†');
        }

        function shareAchievement() {
            if (!checkPremiumFeature('share')) return;
            alert('Basariniz paylasildi! ğŸ‰');
        }

        // GeliÅŸmiÅŸ Analitik
        function exportPDF() {
            if (!checkPremiumFeature('pdf')) return;
            alert('PDF rapor hazirlaniyor... ğŸ“„');
        }

        function showAdvancedAnalytics() {
            if (!checkPremiumFeature('analytics')) return;
            alert('Gelismis analitik yakinda! ğŸ“Š');
        }

        function showTrends() {
            if (!checkPremiumFeature('trends')) return;
            alert('Trend analizi yakinda! ğŸ“ˆ');
        }

        // AI Ã–zellikleri
        function getAIPersonalizedAdvice() {
            if (!checkPremiumFeature('ai_advice')) return;
            alert('AI kisisel onerisi hazirlaniyor... ğŸ¤–');
        }

        function optimizeGoals() {
            if (!checkPremiumFeature('goal_optimization')) return;
            alert('Hedefleriniz optimize ediliyor... âœ¨');
        }

        function predictSuccess() {
            if (!checkPremiumFeature('prediction')) return;
            alert('Basari tahmini hesaplaniyor... ğŸ”®');
        }



        // BugÃ¼nÃ¼n hedeflerini yÃ¼kle
        function loadTodayGoals() {
            displayTodayGoals();
            updateProgress();
        }

        // SeÃ§ili gÃ¼nÃ¼n hedeflerini yÃ¼kle
        function loadSelectedGoals() {
            displaySelectedGoals();
        }

        // BugÃ¼nÃ¼n hedeflerini kaydet (eski sistem - geriye uyumluluk iÃ§in)
        function saveTodayGoals() {
            const today = new Date().toDateString();
            const todayGoals = [];
            
            for (let i = 1; i <= 3; i++) {
                const goal = document.getElementById(`goal${i}`).value.trim();
                if (goal) {
                    todayGoals.push({
                        id: Date.now() + i,
                        text: goal,
                        category: 'genel',
                        completed: false,
                        createdAt: new Date()
                    });
                }
            }
            
            goals[today] = todayGoals;
            autoSave();
            renderCalendar();
            updateProgress();
            alert('Hedefler kaydedildi!');
        }

        // SeÃ§ili gÃ¼nÃ¼n hedeflerini kaydet (eski sistem - geriye uyumluluk iÃ§in)
        function saveSelectedGoals() {
            const dateString = selectedDate.toDateString();
            const selectedGoals = [];
            
            for (let i = 1; i <= 3; i++) {
                const goal = document.getElementById(`selectedGoal${i}`).value.trim();
                if (goal) {
                    selectedGoals.push({
                        id: Date.now() + i,
                        text: goal,
                        category: 'genel',
                        completed: false,
                        createdAt: new Date()
                    });
                }
            }
            
            goals[dateString] = selectedGoals;
            autoSave();
            renderCalendar();
            alert('Hedefler kaydedildi!');
        }

        // Ä°lerleme gÃ¼ncelleme
        function updateProgress() {
            const today = new Date().toDateString();
            const todayGoals = goals[today] || [];
            const completedCount = todayGoals.filter(goal => goal.completed).length;
            const totalCount = todayGoals.length;
            
            const progress = totalCount > 0 ? (completedCount / totalCount) * 100 : 0;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `${completedCount}/${totalCount} hedef tamamlandÄ±`;
        }

        // BugÃ¼nÃ¼ tamamla
        function completeToday() {
            const today = new Date().toDateString();
            completedDays[today] = true;
            
            // Gamification
            addPoints(50);
            checkStreak();
            checkBadges();
            
            updateStats();
            autoSave();
            
            // Bildirim gÃ¶nder
            sendNotification('MiniPlan', 'GÃ¼nÃ¼ baÅŸarÄ±yla tamamladÄ±nÄ±z! +50 puan kazandÄ±nÄ±z! ğŸ‰');
            alert('Gunu basarili tamamladiniz! +50 puan kazandiniz! ğŸ‰');
        }

        // Gamification fonksiyonlarÄ±
        function addPoints(points) {
            userStats.points += points;
            checkLevelUp();
            saveUserData();
        }

        function checkLevelUp() {
            const newLevel = Math.floor(userStats.points / 100) + 1;
            if (newLevel > userStats.level) {
                userStats.level = newLevel;
                alert(`Seviye atladiniz! Yeni seviye: ${newLevel} ğŸš€`);
            }
        }

        function checkStreak() {
            const today = new Date().toDateString();
            const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000).toDateString();
            
            if (completedDays[yesterday]) {
                userStats.streak++;
            } else {
                userStats.streak = 1;
            }
            
            if (userStats.streak % 7 === 0) {
                showNotification(`7 gÃ¼nlÃ¼k seri! +100 bonus puan! ğŸ”¥`);
                addPoints(100);
            }
        }

        function checkBadges() {
            const badges = [
                { id: 'first_goal', name: 'Ä°lk Hedef', icon: 'ğŸ¯', condition: () => Object.keys(goals).length >= 1 },
                { id: 'week_streak', name: 'HaftalÄ±k Seri', icon: 'ğŸ”¥', condition: () => userStats.streak >= 7 },
                { id: 'month_streak', name: 'AylÄ±k Seri', icon: 'â­', condition: () => userStats.streak >= 30 },
                { id: 'level_5', name: 'Seviye 5', icon: 'ğŸš€', condition: () => userStats.level >= 5 },
                { id: 'level_10', name: 'Seviye 10', icon: 'ğŸ‘‘', condition: () => userStats.level >= 10 },
                { id: 'perfect_day', name: 'MÃ¼kemmel GÃ¼n', icon: 'ğŸ’', condition: () => {
                    const today = new Date().toDateString();
                    const todayGoals = goals[today] || [];
                    return todayGoals.length > 0 && todayGoals.every(goal => goal.completed);
                }}
            ];
            
            badges.forEach(badge => {
                if (!userStats.badges.includes(badge.id) && badge.condition()) {
                    userStats.badges.push(badge.id);
                    alert(`Yeni rozet kazandiniz: ${badge.name} ğŸ†`);
                    addPoints(25);
                    displayBadges();
                }
            });
        }

        function displayBadges() {
            const container = document.getElementById('badgesContainer');
            if (!container) return;
            
            // userStats.badges kontrolÃ¼
            if (!userStats || !userStats.badges) {
                userStats = userStats || {};
                userStats.badges = userStats.badges || [];
            }
            
            const badgeData = {
                'first_goal': { name: 'Ä°lk Hedef', icon: 'ğŸ¯' },
                'week_streak': { name: 'HaftalÄ±k Seri', icon: 'ğŸ”¥' },
                'month_streak': { name: 'AylÄ±k Seri', icon: 'â­' },
                'level_5': { name: 'Seviye 5', icon: 'ğŸš€' },
                'level_10': { name: 'Seviye 10', icon: 'ğŸ‘‘' },
                'perfect_day': { name: 'MÃ¼kemmel GÃ¼n', icon: 'ğŸ’' }
            };
            
            container.innerHTML = userStats.badges.map(badgeId => {
                const badge = badgeData[badgeId];
                return `<div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 8px 12px; border-radius: 20px; font-size: 12px; display: flex; align-items: center; gap: 5px;">
                    <span>${badge.icon}</span>
                    <span>${badge.name}</span>
                </div>`;
            }).join('');
        }

        // AI Hedef Ã–nerileri
        function generateAISuggestions() {
            const suggestions = [
                "ğŸ’¼ Ä°ÅŸ: Ã–nemli bir projeyi tamamlayÄ±n veya yeni bir beceri Ã¶ÄŸrenin",
                "ğŸƒâ€â™‚ï¸ SaÄŸlÄ±k: 30 dakika egzersiz yapÄ±n veya saÄŸlÄ±klÄ± bir Ã¶ÄŸÃ¼n hazÄ±rlayÄ±n",
                "ğŸ“š Ã–ÄŸrenme: Yeni bir kitap okuyun veya online kursa baÅŸlayÄ±n",
                "ğŸ‘¥ Sosyal: Bir arkadaÅŸÄ±nÄ±zla gÃ¶rÃ¼ÅŸÃ¼n veya ailenizi arayÄ±n",
                "ğŸ§˜â€â™€ï¸ KiÅŸisel: Meditasyon yapÄ±n veya gÃ¼nlÃ¼k tutun",
                "ğŸ¨ YaratÄ±cÄ±lÄ±k: Bir hobi projesi baÅŸlatÄ±n veya sanat eseri yaratÄ±n",
                "ğŸ’° Finans: BÃ¼tÃ§enizi gÃ¶zden geÃ§irin veya tasarruf hedefi belirleyin",
                "ğŸ  Ev: Bir odanÄ±zÄ± dÃ¼zenleyin veya yeni bir dekorasyon projesi baÅŸlatÄ±n"
            ];
            
            const randomSuggestions = suggestions.sort(() => 0.5 - Math.random()).slice(0, 3);
            const container = document.getElementById('aiSuggestions');
            
            if (!container) return;
            
            container.innerHTML = randomSuggestions.map(suggestion => 
                `<div style="margin-bottom: 8px; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 5px;">
                    ${suggestion}
                </div>`
            ).join('');
        }

        // Ä°statistikleri gÃ¼ncelle
        function updateStats() {
            const totalDays = Object.keys(completedDays).length;
            const allGoals = Object.values(goals).filter(Array.isArray).flat();
            const completedGoals = allGoals.filter(goal => goal.completed).length;
            const successRate = allGoals.length > 0 ? Math.round((completedGoals / allGoals.length) * 100) : 0;
            
            const totalDaysElement = document.getElementById('totalDays');
            const completedGoalsElement = document.getElementById('completedGoals');
            const successRateElement = document.getElementById('successRate');
            
            if (totalDaysElement) totalDaysElement.textContent = totalDays;
            if (completedGoalsElement) completedGoalsElement.textContent = completedGoals;
            if (successRateElement) successRateElement.textContent = successRate + '%';
            
            // Gamification istatistikleri
            const userPointsElement = document.getElementById('userPoints');
            const userLevelElement = document.getElementById('userLevel');
            const userStreakElement = document.getElementById('userStreak');
            
            if (userPointsElement) userPointsElement.textContent = userStats.points;
            if (userLevelElement) userLevelElement.textContent = userStats.level;
            if (userStreakElement) userStreakElement.textContent = userStats.streak;
            
            // HaftalÄ±k raporu gÃ¼ncelle
            updateWeeklyReport();
        }

        // GeliÅŸmiÅŸ analitik gÃ¼ncelleme
        function updateAnalytics() {
            // goals objesinin yÃ¼klendiÄŸinden emin ol
            if (!goals) {
                goals = {};
            }
            updateWeeklyReport();
            updateCategoryChart();
            updateTimeChart();
        }

        // HaftalÄ±k rapor gÃ¼ncelle
        function updateWeeklyReport() {
            // goals objesinin yÃ¼klendiÄŸinden emin ol
            if (!goals) {
                goals = {};
            }
            
            const today = new Date();
            const weekStart = new Date(today);
            weekStart.setDate(today.getDate() - today.getDay());
            
            let weeklyGoals = 0;
            let weeklyCompleted = 0;
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(weekStart);
                date.setDate(weekStart.getDate() + i);
                const dateString = date.toDateString();
                
                if (goals[dateString]) {
                    weeklyGoals += goals[dateString].length;
                    weeklyCompleted += goals[dateString].filter(goal => goal.completed).length;
                }
            }
            
            const weeklyRate = weeklyGoals > 0 ? Math.round((weeklyCompleted / weeklyGoals) * 100) : 0;
            
            const weeklyGoalsElement = document.getElementById('weeklyGoals');
            const weeklyCompletedElement = document.getElementById('weeklyCompleted');
            const weeklyRateElement = document.getElementById('weeklyRate');
            
            if (weeklyGoalsElement) weeklyGoalsElement.textContent = weeklyGoals;
            if (weeklyCompletedElement) weeklyCompletedElement.textContent = weeklyCompleted;
            if (weeklyRateElement) weeklyRateElement.textContent = weeklyRate + '%';
        }

        // Kategori grafiÄŸi gÃ¼ncelle
        function updateCategoryChart() {
            // goals objesinin yÃ¼klendiÄŸinden emin ol
            if (!goals) {
                goals = {};
            }
            
            const categoryStats = {};
            const allGoals = Object.values(goals).filter(Array.isArray).flat();
            
            allGoals.forEach(goal => {
                if (!categoryStats[goal.category]) {
                    categoryStats[goal.category] = { total: 0, completed: 0 };
                }
                categoryStats[goal.category].total++;
                if (goal.completed) categoryStats[goal.category].completed++;
            });
            
            const container = document.getElementById('categoryChart');
            container.innerHTML = '';
            
            Object.entries(categoryStats).forEach(([category, stats]) => {
                const percentage = stats.total > 0 ? (stats.completed / stats.total) * 100 : 0;
                const height = Math.max(20, percentage);
                
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.width = '30px';
                bar.style.height = height + '%';
                bar.title = `${getCategoryIcon(category)} ${stats.completed}/${stats.total} (${Math.round(percentage)}%)`;
                
                const label = document.createElement('div');
                label.className = 'chart-label';
                label.textContent = getCategoryIcon(category);
                
                const wrapper = document.createElement('div');
                wrapper.style.display = 'flex';
                wrapper.style.flexDirection = 'column';
                wrapper.style.alignItems = 'center';
                wrapper.appendChild(bar);
                wrapper.appendChild(label);
                
                container.appendChild(wrapper);
            });
        }

        // Zaman grafiÄŸi gÃ¼ncelle
        function updateTimeChart() {
            // goals objesinin yÃ¼klendiÄŸinden emin ol
            if (!goals) {
                goals = {};
            }
            
            const timeStats = {};
            const allGoals = Object.values(goals).filter(Array.isArray).flat();
            
            allGoals.forEach(goal => {
                const hour = new Date(goal.createdAt).getHours();
                if (!timeStats[hour]) timeStats[hour] = 0;
                timeStats[hour]++;
            });
            
            const container = document.getElementById('timeChart');
            container.innerHTML = '';
            
            for (let hour = 0; hour < 24; hour++) {
                const count = timeStats[hour] || 0;
                const height = Math.max(10, count * 10);
                
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.width = '8px';
                bar.style.height = height + '%';
                bar.title = `${hour}:00 - ${count} hedef`;
                
                container.appendChild(bar);
            }
        }

        // BugÃ¼nÃ¼n tarihini gÃ¼ncelle
        function updateTodayDate() {
            const today = new Date();
            document.getElementById('todayDate').textContent = 
                today.toLocaleDateString('tr-TR', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
        }

        // Takvim navigasyonu
        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        }
    </script>
</body>
</html> 
